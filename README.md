# è™šå¹»å¼•æ“æ–‡æ¡£ MCP æœåŠ¡å™¨

è¿™ä¸ªé¡¹ç›®æä¾›è™šå¹»å¼•æ“å®˜æ–¹æ–‡æ¡£çš„ MCPï¼ˆModel Context Protocolï¼‰æœåŠ¡å™¨ï¼Œæ”¯æŒ**åŸºäºå‘é‡è¯­ä¹‰æœç´¢**çš„æ™ºèƒ½æ–‡æ¡£æŸ¥è¯¢å’Œè®¿é—®åŠŸèƒ½ã€‚

## é¡¹ç›®èƒŒæ™¯

è™šå¹»å¼•æ“å®˜æ–¹æ–‡æ¡£ç½‘ç«™ä½¿ç”¨åŠ¨æ€åŠ è½½çš„å¯¼èˆªèœå•ï¼Œåªæœ‰ç‚¹å‡»å±•å¼€æŒ‰é’®æ‰èƒ½æ˜¾ç¤ºå­èœå•é¡¹ã€‚ä¼ ç»Ÿçš„é™æ€HTMLæŠ“å–åªèƒ½è·å–åˆ°ç¬¬ä¸€å±‚çš„å¯¼èˆªé“¾æ¥ï¼Œæ— æ³•è·å–å®Œæ•´çš„æ–‡æ¡£ç»“æ„ã€‚

## è§£å†³æ–¹æ¡ˆ

æœ¬é¡¹ç›®é‡‡ç”¨å¤šå±‚æ¬¡æŠ€æœ¯æ–¹æ¡ˆï¼š

1. **æ— å¤´æµè§ˆå™¨è‡ªåŠ¨åŒ–**: ä½¿ç”¨ Puppeteer æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œè‡ªåŠ¨ç‚¹å‡»æ‰€æœ‰å¯å±•å¼€çš„èœå•é¡¹
2. **å®Œæ•´æ•°æ®é‡‡é›†**: è·å–å®Œæ•´çš„å¯¼èˆªç»“æ„å¹¶æŠ“å–æ¯ä¸ªé¡µé¢çš„æ ‡é¢˜å’Œæè¿°ä¿¡æ¯
3. **å‘é‡è¯­ä¹‰æœç´¢**: åŸºäº LanceDB å’Œ Ollama æ„å»ºè¯­ä¹‰æœç´¢å¼•æ“ï¼Œæä¾›æ™ºèƒ½æ–‡æ¡£æ£€ç´¢

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **è‡ªåŠ¨åŒ–å±•å¼€**: ä½¿ç”¨æ— å¤´æµè§ˆå™¨è‡ªåŠ¨å±•å¼€æ‰€æœ‰èœå•é¡¹
- ğŸ“Š **æ•°æ®å¯¹æ¯”**: å¯¹æ¯”é™æ€å’ŒåŠ¨æ€è·å–çš„é“¾æ¥æ•°é‡
- ğŸ”„ **å¢é‡æ›´æ–°**: å¤šè½®å±•å¼€ç­–ç•¥ç¡®ä¿è·å–æ‰€æœ‰åµŒå¥—èœå•
- ğŸ“ **ç»“æ„åŒ–è¾“å‡º**: ç”ŸæˆJSONæ ¼å¼çš„å¢å¼ºé“¾æ¥åˆ—è¡¨
- ğŸ“ **é¡µé¢ä¿¡æ¯**: è‡ªåŠ¨è·å–æ¯ä¸ªé¡µé¢çš„æ ‡é¢˜å’Œmeta description
- ğŸ§  **è¯­ä¹‰æœç´¢**: åŸºäºå‘é‡åµŒå…¥çš„æ™ºèƒ½æœç´¢ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢
- ğŸ” **å¤šç»´åº¦æœç´¢**: æ”¯æŒåŸºäºå¯¼èˆªæ ‡é¢˜ã€é¡µé¢æ ‡é¢˜å’Œæè¿°çš„å…¨æ–‡æœç´¢

## æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ scripts/                    # æ„å»ºè„šæœ¬ (TypeScript)
â”‚   â”œâ”€â”€ fetch-nav.ts            # åŠ¨æ€è·å–å¯¼èˆªç»“æ„
â”‚   â”œâ”€â”€ parse-nav.ts            # è§£æHTMLå¹¶ç”ŸæˆJSON
â”‚   â”œâ”€â”€ fetch-descriptions.ts   # è·å–é¡µé¢æ ‡é¢˜å’Œæè¿°ä¿¡æ¯
â”‚   â”œâ”€â”€ merge-data.ts           # åˆå¹¶å¯¼èˆªå’Œé¡µé¢æ•°æ®
â”‚   â””â”€â”€ build-vector-db.ts      # æ„å»ºå‘é‡æ•°æ®åº“
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ index.ts                # MCPæœåŠ¡å™¨å®ç°
â”‚   â””â”€â”€ vector-search.ts        # å‘é‡æœç´¢å¼•æ“
â”œâ”€â”€ sources/                    # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ list.json               # åŸºç¡€é“¾æ¥åˆ—è¡¨
â”‚   â”œâ”€â”€ descriptions.json       # é¡µé¢æè¿°æ•°æ®
â”‚   â”œâ”€â”€ enhanced-list.json      # å¢å¼ºé“¾æ¥æ•°æ® (åˆå¹¶å)
â”‚   â””â”€â”€ db/                     # å‘é‡æ•°æ®åº“
â”œâ”€â”€ tests/                      # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ mcp-client.test.ts      # MCPå®¢æˆ·ç«¯æµ‹è¯•
â”œâ”€â”€ dist/                       # ç¼–è¯‘åçš„JavaScriptæ–‡ä»¶
â”œâ”€â”€ nav-dist.html               # åŠ¨æ€è·å–çš„å®Œæ•´å¯¼èˆª(2415ä¸ªé“¾æ¥)
â”œâ”€â”€ tsconfig.json               # TypeScripté…ç½®
â”œâ”€â”€ tsconfig.build.json         # æ„å»ºé…ç½®
â””â”€â”€ package.json                # é¡¹ç›®é…ç½®
```

## å®‰è£…ä¸é…ç½®

### å‰ç½®è¦æ±‚

1. **Node.js**: ç‰ˆæœ¬ >= 18.0.0
2. **Ollama**: ç”¨äºå‘é‡åµŒå…¥ç”Ÿæˆ
   ```bash
   # å®‰è£… Ollama (æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿ)
   curl -fsSL https://ollama.ai/install.sh | sh
   
   # ä¸‹è½½åµŒå…¥æ¨¡å‹
   ollama pull bge-m3
   ```

### å®‰è£…ä¾èµ–
```bash
npm install
```

### æ„å»ºé¡¹ç›®
```bash
npm run build
```

## ä½¿ç”¨æ–¹æ³•

### 1. æ„å»ºæ–‡æ¡£æ•°æ®

å®Œæ•´çš„æ„å»ºæµç¨‹ï¼š
```bash
# å®Œæ•´æ„å»ºæµç¨‹ (è·å–å¯¼èˆªâ†’è§£æâ†’è·å–æè¿°â†’åˆå¹¶æ•°æ®)
npm run build-docs
```

åˆ†æ­¥æ‰§è¡Œï¼š
```bash
# 1. è·å–åŠ¨æ€å¯¼èˆªç»“æ„
npm run fetch-nav

# 2. è§£æHTMLç”Ÿæˆé“¾æ¥åˆ—è¡¨
npm run parse-nav

# 3. è·å–é¡µé¢æ ‡é¢˜å’Œæè¿°
npm run fetch-descriptions

# 4. åˆå¹¶æ•°æ®ç”Ÿæˆå¢å¼ºé“¾æ¥åˆ—è¡¨
npm run merge-data
```

### 2. æ„å»ºå‘é‡æ•°æ®åº“ (å¯é€‰)

å¦‚æœéœ€è¦ä½¿ç”¨è¯­ä¹‰æœç´¢åŠŸèƒ½ï¼š
```bash
# ç¡®ä¿ Ollama æœåŠ¡æ­£åœ¨è¿è¡Œ
ollama serve

# æ„å»ºå‘é‡æ•°æ®åº“
npm run build-vector-db
```

### 3. è¿è¡ŒMCPæœåŠ¡å™¨
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

## MCPå·¥å…·åŠŸèƒ½

### search_docs_list

æŸ¥è¯¢å¹¶è¿”å›è™šå¹»å¼•æ“å®˜æ–¹æ–‡æ¡£é“¾æ¥åˆ—è¡¨ï¼Œæ”¯æŒ**å‘é‡è¯­ä¹‰æœç´¢**æŠ€æœ¯ã€‚

**å‚æ•°:**
- `search` (å¿…éœ€): æœç´¢å…³é”®å­—ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢
- `limit` (å¯é€‰): è¿”å›ç»“æœçš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤10ä¸ª

**è¿”å›æ•°æ®æ ¼å¼:**
```json
{
  "total": 2415,
  "search": "è§’è‰²åŠ¨ç”»åˆ¶ä½œ",
  "searchMethod": "semantic_search",
  "limit": 1,
  "vectorSearchAvailable": true,
  "links": [
    {
      "navTitle": "ç‰©ä½“å’Œè§’è‰²åŠ¨ç”»åˆ¶ä½œ",
      "pageTitle": "åœ¨è™šå¹»å¼•æ“ä¸­åˆ¶ä½œè§’è‰²å’Œç‰©ä½“åŠ¨ç”»",
      "pageDescription": "å­¦ä¹ å¦‚ä½•åœ¨è™šå¹»å¼•æ“ä¸­åˆ›å»ºå’Œç®¡ç†è§’è‰²ä¸ç‰©ä½“çš„åŠ¨ç”»ç³»ç»Ÿï¼ŒåŒ…æ‹¬åŠ¨ç”»è“å›¾ã€çŠ¶æ€æœºç­‰é«˜çº§åŠŸèƒ½ã€‚",
      "link": "https://dev.epicgames.com/documentation/zh-cn/unreal-engine/animating-characters-and-objects-in-unreal-engine"
    }
  ]
}
```

**æœç´¢æ¨¡å¼è¯´æ˜:**
- `semantic_search`: å‘é‡è¯­ä¹‰æœç´¢ (æ¨è)
- `semantic_search_unavailable`: å‘é‡æœç´¢ä¸å¯ç”¨
- `semantic_search_failed`: å‘é‡æœç´¢å¤±è´¥
- `no_search`: æœªæä¾›æœç´¢å…³é”®å­—

**ä½¿ç”¨ç¤ºä¾‹:**
- è¯­ä¹‰æœç´¢åŠ¨ç”»: `search_docs_list(search="å¦‚ä½•åˆ¶ä½œè§’è‰²åŠ¨ç”»")`
- æœç´¢è“å›¾åŠŸèƒ½: `search_docs_list(search="è“å›¾ç¼–ç¨‹æ•™ç¨‹")`
- æŸ¥æ‰¾å®‰è£…æŒ‡å—: `search_docs_list(search="å®‰è£…è™šå¹»å¼•æ“")`
- æ–°åŠŸèƒ½æ¢ç´¢: `search_docs_list(search="æœ€æ–°åŠŸèƒ½å’Œæ›´æ–°")`

## æ•°æ®ç»Ÿè®¡

### é‡‡é›†æˆæœ
- **åŸå§‹å¯¼èˆªé“¾æ¥**: 87ä¸ª
- **åŠ¨æ€è·å–é“¾æ¥**: 2415ä¸ª  
- **æ–°å¢é“¾æ¥æ•°é‡**: 2328ä¸ª
- **å±•å¼€èœå•é¡¹**: 492ä¸ª
- **å±•å¼€è½®æ¬¡**: 7è½®

### æ•°æ®å®Œæ•´æ€§
- **é¡µé¢æ ‡é¢˜è¦†ç›–ç‡**: ~98.5%
- **é¡µé¢æè¿°è¦†ç›–ç‡**: ~97.2%
- **å‘é‡åŒ–æ–‡æ¡£æ•°é‡**: 2415ä¸ª
- **å‘é‡ç»´åº¦**: 1024 (bge-m3æ¨¡å‹)

## æŠ€æœ¯å®ç°

### å‘é‡æœç´¢å¼•æ“

åŸºäºä»¥ä¸‹æŠ€æœ¯æ ˆï¼š
- **LanceDB**: é«˜æ€§èƒ½å‘é‡æ•°æ®åº“
- **Ollama**: æœ¬åœ°åµŒå…¥æ¨¡å‹æœåŠ¡
- **bge-m3**: å¤šè¯­è¨€åµŒå…¥æ¨¡å‹ï¼Œæ”¯æŒä¸­è‹±æ–‡æ··åˆæŸ¥è¯¢

### æœç´¢å·¥ä½œæµç¨‹

1. **æ–‡æœ¬é¢„å¤„ç†**: åˆå¹¶å¯¼èˆªæ ‡é¢˜ã€é¡µé¢æ ‡é¢˜å’Œæè¿°
2. **å‘é‡åŒ–**: ä½¿ç”¨ bge-m3 æ¨¡å‹ç”Ÿæˆæ–‡æ¡£åµŒå…¥å‘é‡
3. **å­˜å‚¨**: å°†å‘é‡å­˜å‚¨åˆ° LanceDB ä¸­
4. **æŸ¥è¯¢**: å°†ç”¨æˆ·æŸ¥è¯¢è½¬æ¢ä¸ºå‘é‡å¹¶æ‰§è¡Œç›¸ä¼¼åº¦æœç´¢
5. **æ’åº**: åŸºäºç›¸ä¼¼åº¦åˆ†æ•°è¿”å›æœ€ç›¸å…³ç»“æœ

### è‡ªåŠ¨åŒ–å±•å¼€ç­–ç•¥

```javascript
// æŸ¥æ‰¾æœªå±•å¼€çš„èœå•æŒ‰é’®
const expandButtons = await page.$$('.btn-expander .icon-arrow-forward-ios:not(.is-rotated)');
```

### é”™è¯¯å¤„ç†æœºåˆ¶
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ
- DOMæ›´æ–°ç­‰å¾…
- å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•
- å‘é‡æœåŠ¡è¿æ¥æ£€æµ‹

## ç”Ÿæˆçš„æ•°æ®æ ¼å¼

### enhanced-list.json - å¢å¼ºé“¾æ¥æ•°æ®
```json
{
  "total": 2415,
  "generated": "2025-01-12T10:30:15.387Z",
  "stats": {
    "totalLinks": 2415,
    "withPageTitle": 2380,
    "withPageDescription": 2347,
    "completionRate": {
      "pageTitle": "98.5%",
      "pageDescription": "97.2%"
    }
  },
  "links": [
    {
      "navTitle": "æ–°å†…å®¹",
      "pageTitle": "è™šå¹»å¼•æ“æ–°åŠŸèƒ½",
      "pageDescription": "äº†è§£è™šå¹»å¼•æ“5.6çš„æ–°åŠŸèƒ½å’Œæ”¹è¿›ã€‚",
      "link": "https://dev.epicgames.com/documentation/zh-cn/unreal-engine/whats-new"
    }
  ]
}
```

## æ€§èƒ½æŒ‡æ ‡

### æ„å»ºæ€§èƒ½
- æµè§ˆå™¨å¯åŠ¨: ~2-3ç§’
- é¡µé¢åŠ è½½: ~5-10ç§’  
- å¯¼èˆªå±•å¼€: ~30-60ç§’
- æ•°æ®è§£æ: ~1-2ç§’
- å‘é‡åŒ–å¤„ç†: ~5-10åˆ†é’Ÿ (2415ä¸ªæ–‡æ¡£)
- æ€»æ„å»ºæ—¶é—´: ~15-20åˆ†é’Ÿ

### æŸ¥è¯¢æ€§èƒ½
- å‘é‡æœç´¢å“åº”: <200æ¯«ç§’
- æ•°æ®åº“è¿æ¥: <100æ¯«ç§’
- åµŒå…¥å‘é‡ç”Ÿæˆ: ~50-100æ¯«ç§’

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯
- **Node.js**: è¿è¡Œç¯å¢ƒ
- **TypeScript**: ç±»å‹å®‰å…¨çš„å¼€å‘è¯­è¨€
- **MCP SDK**: Model Context Protocol å®ç°

### æ•°æ®é‡‡é›†
- **Puppeteer**: æ— å¤´æµè§ˆå™¨æ§åˆ¶
- **JSDOM**: HTMLè§£æå’Œå¤„ç†
- **Playwright**: æµè§ˆå™¨å®‰è£…ç®¡ç†

### æœç´¢æŠ€æœ¯
- **LanceDB**: å‘é‡æ•°æ®åº“
- **Ollama**: æœ¬åœ°AIæ¨¡å‹æœåŠ¡
- **bge-m3**: å¤šè¯­è¨€åµŒå…¥æ¨¡å‹
- **Apache Arrow**: é«˜æ€§èƒ½æ•°æ®å¤„ç†

### å¼€å‘å·¥å…·
- **Vitest**: å•å…ƒæµ‹è¯•æ¡†æ¶
- **tsx**: TypeScriptæ‰§è¡Œå™¨
- **Zod**: å‚æ•°éªŒè¯
- **Rimraf**: è·¨å¹³å°æ–‡ä»¶åˆ é™¤

## ç¯å¢ƒå˜é‡

```bash
# æœç´¢ç»“æœé»˜è®¤é™åˆ¶æ•°é‡
SEARCH_LIMIT_DEFAULT=10

# OllamaæœåŠ¡åœ°å€ (å¯é€‰)
OLLAMA_BASE_URL=http://localhost:11434

# åµŒå…¥æ¨¡å‹åç§° (å¯é€‰)
OLLAMA_MODEL=bge-m3
```

## å¼€å‘ä¸æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# æ‰§è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch
```

### å¼€å‘æ¨¡å¼
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

## æ•…éšœæ’é™¤

### å‘é‡æœç´¢ä¸å¯ç”¨
1. æ£€æŸ¥ Ollama æœåŠ¡æ˜¯å¦è¿è¡Œ: `ollama serve`
2. ç¡®è®¤æ¨¡å‹å·²å®‰è£…: `ollama list`
3. æ£€æŸ¥å‘é‡æ•°æ®åº“æ˜¯å¦å­˜åœ¨: `sources/db/`
4. é‡æ–°æ„å»ºå‘é‡æ•°æ®åº“: `npm run build-vector-db`

### æ•°æ®è·å–å¤±è´¥
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ç¡®è®¤è™šå¹»å¼•æ“æ–‡æ¡£ç½‘ç«™å¯è®¿é—®
3. æ£€æŸ¥æµè§ˆå™¨å®‰è£…: `npm run install-browsers`

## åç»­ä¼˜åŒ–è®¡åˆ’

- [ ] æ”¯æŒå¢é‡æ•°æ®æ›´æ–°
- [ ] æ·»åŠ å¤šè¯­è¨€ç‰ˆæœ¬æ”¯æŒ  
- [ ] å®ç°åˆ†å¸ƒå¼å‘é‡æœç´¢
- [ ] ä¼˜åŒ–å‘é‡åŒ–å¤„ç†æ€§èƒ½
- [ ] æ·»åŠ æœç´¢ç»“æœç¼“å­˜
- [ ] æ”¯æŒè‡ªå®šä¹‰åµŒå…¥æ¨¡å‹
- [ ] å®ç°æœç´¢å†å²åˆ†æ
- [ ] æ·»åŠ APIé€Ÿç‡é™åˆ¶

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. è¿è¡Œæµ‹è¯•ç¡®ä¿é€šè¿‡
5. æäº¤Pull Request

## è®¸å¯è¯

MIT License 